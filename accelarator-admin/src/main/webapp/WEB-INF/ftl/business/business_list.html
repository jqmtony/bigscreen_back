<#assign base=request.contextPath/>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<link rel="stylesheet" type="text/css" href="${base}/easyui/themes/default/easyui.css" />
<link rel="stylesheet" type="text/css" href="${base}/easyui/themes/icon.css" />
<script type="text/javascript" src="${base}/js/jquery.min.js"></script>
<script type="text/javascript" src="${base}/easyui/jquery.easyui.min.js"></script>
<script type="text/javascript" src="${base}/easyui/locale/easyui-lang-zh_CN.js"></script>
<script type="text/javascript" src="${base}/js/extend.js"></script>
</head>
<body>
   <table id="dg_search_0" class="easyui-datagrid" data-options="rownumbers:true,singleSelect:true,url:'${base}/business/list',method:'post',toolbar:'#tb',pagination:true,pageSize:20,pageNumber:1,fitColumns:true,fit:true">
		<thead>
			<tr>
				<th data-options="field:'userName',width:80">用户名</th>
				<th data-options="field:'realName',width:100">真实姓名</th>
				<th data-options="field:'mobile',width:80">手机</th>
				<th data-options="field:'email',width:100">邮箱</th>
				<th data-options="field:'country',width:80">国家</th>
				<th data-options="field:'area',width:80">地区</th>
				<th data-options="field:'createTime',width:100">创建日期</th>
				<th data-options="field:'status',width:60,formatter:formatStatus">是否启用</th>
			</tr>
		</thead>
	</table>
	
	<div id="tb" style="padding:2px 5px;">
	            国家： <input class="easyui-textbox" type="text" id="country" style="width:110px">
	            地区： <input class="easyui-textbox" type="text" id="area" style="width:110px">
		用户名： <input class="easyui-textbox" type="text" id="userName" style="width:110px">
		真实姓名： <input class="easyui-textbox" type="text" id="realName" style="width:110px">
		<a href="javascript:void(0);" onclick="search_()" class="easyui-linkbutton" iconCls="icon-search">查询</a>
		<a href="javascript:void(0);" id="btn_add_user" class="easyui-linkbutton" data-options="iconCls:'icon-add',toggle:true">添加</a>
		<a href="javascript:void(0);" class="easyui-linkbutton" onclick="dg_remove_row();" data-options="iconCls:'icon-remove',toggle:true">删除</a>
		<a href="#" class="easyui-linkbutton" data-options="iconCls:'icon-cut',toggle:true">修改</a>
	</div>
	
	<div id="win_add_user" class="easyui-window" title="新增商家账号" data-options="collapsible:false,minimizable:false,closed:true" style="width:600px;height:450px;padding:10px;">
	     <form id="ff" method="post">
	    	<table cellpadding="5">
	    		<tr>
	    			<td>用户名：</td>
	    			<td><input class="easyui-textbox" type="text" name="userName" data-options="required:true"></input></td>
	    			<td>真实姓名：</td>
	    			<td><input class="easyui-textbox" type="text" name="realName" data-options="required:true"></input></td>
	    		</tr>
	    		<tr>
	    			<td>密码：</td>
	    			<td><input class="easyui-textbox" type="text" name="password" data-options="required:true"></input></td>
	    			<td>确认密码：</td>
	    			<td><input class="easyui-textbox" type="text" name="password_two" data-options="required:true"></input></td>
	    		</tr>
	    		<tr>
	    			<td>国家：</td>
	    			<td><input class="easyui-textbox" type="text" name="country" data-options="required:true"></input></td>
	    			<td>地区：</td>
	    			<td><input class="easyui-textbox" type="text" name="area" data-options="required:true"></input></td>
	    		</tr>
	    		<tr>
	    			<td>手机：</td>
	    			<td><input class="easyui-textbox" type="text" name="mobile" data-options="required:true"></input></td>
	    			<td>电子邮箱：</td>
	    			<td><input class="easyui-textbox" type="text" name="email" data-options="required:true,validType:'email'"></input></td>
	    		</tr>
	    		<tr>
	    			<td>微信号：</td>
	    			<td><input class="easyui-textbox" type="text" name="weixin"></input></td>
	    			<td>FaceBook：</td>
	    			<td><input class="easyui-textbox" type="text" name="facebook"></input></td>
	    		</tr>
	    		<tr>
	    			<td>出生年月：</td>
	    			<td colspan="3"><input class="easyui-textbox" type="text" name="birthday"></input></td>
	    		</tr>
	    		<tr>
	    			<td>备注：</td>
	    			<td><input class="easyui-textbox" name="remark" data-options="multiline:true" style="height:60px"></input></td>
	    		</tr>
               </table>
            </form>
            <div style="text-align:center;padding:5px">
		    	<a href="javascript:void(0)" class="easyui-linkbutton" onclick="submitForm()">保存</a>
		    	<a href="javascript:void(0)" class="easyui-linkbutton" onclick="clearForm()">关闭</a>
		    </div>
            
    </div>
    
</body>
</html>

<script>
$(function(){
	$("#btn_add_user").click(function(){
		$("#win_add_user").window('open');
	});
});

function search_() {
   var settings={
		url:'${base}/business/list',
		params:{
			country:$("#country").val()?$("#country").val():0,
			area:$("#area").val()?$("#area").val():0,
			userName:$("#userName").val(),
			realName:$("#realName").val()
		}
   };
   crud.search(settings);
}

function dg_remove_row() {
	var record = $('#dg_search_0').datagrid('getSelected');
	if (null == record) {
		$.messager.alert('消息提示', '请选择删除记录行！', 'info');
	} else {
		$.ajax({
			type : "POST",
			url : "${base}/business/delete",
			data : {
				id : record.id,
				status : 2
			},
			success : function(msg) {
				if (msg.code == '200') {
					$('#dg_search_0').datagrid('reload');
					$.messager.show({
						title : '操作结果',
						msg : '操作成功！',
						timeout : 2000,
						showType : 'slide'
					});
				}
			}
		})
	}
}

function formatStatus(val, row) {
	if (val == 1) {
		return '已启用';
	} else {
		return '已禁用';
	}
}
</script>