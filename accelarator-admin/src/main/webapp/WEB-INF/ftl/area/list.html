<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<#include "/frame/pageInclude.html">
<title>地区管理</title>

<script type="text/javascript">
	$(function(){
		grid =	$('#areaTreeGrid').treegrid({
				title:'地域管理',
				nowrap: false,
				rownumbers: true,
				mouseoverShowObar:true,
				animate:true,
				url:'${base}/area/querySynAreaList',
				idField:'areaCode',
				treeField:'areaNameH',
				height:420,
				width:800,
				toolbar : [ {
					text : '新建',
					iconCls : 'icon-add',
					handler : add
				}, {
					text : '修改',
					iconCls : 'icon-cut',
					handler : modify
				}, {
					text : '删除',
					iconCls : 'icon-remove',
					handler : deleteArea
				} ],
			
					onDblClickRow:function(row){
						modifyRow(row);
					}
			});
			
		
	});
	
	//模块名称
	function deleteArea(){
		var row = getChecked();
		if (row){
			$.messager.confirm('系统提示', '确定要删除这条记录吗？', function(r){
				if (r){
					$.post('delete/'+row.areaCode,'',addCallback,'json');
				}
			});
		} else {
			$.messager.show({
				title:'系统提示', 
				msg:'请先选择信息'
			});
		}
	}
	
	//得到选择的树列表
	function getChecked(){   
  		var row = grid.treegrid('getSelected');
		if(row){
			 return row;
		}else{
			$.messager.show({
					title:'警告', 
					msg:'请先选择地域项。'
		});
		}
   }

	
	//菜单右键
	function rightMenu(eve){
		var left=0;
		var top=0;
		if(eve.pageY||eve.pageX){
  			 //火狐
  			 top = eve.pageY +10;
  			 left = eve.pageX +10;
  		 }else{
  			 //IE
  			 left = event.clientX + document.body.scrollLeft+ document.documentElement.scrollLeft +10;
  			 top = event.clientY + document.body.scrollTop + document.documentElement.scrollTop + 10;
  		 }
			$('#rightMenu').menu('show',{
					left:left,
					top:top
				});
		return false;
	}
	
/* 	$(function(){
		$('#addsort').numberbox({min:1,max:99,precision:0});
		$('#updatesort').numberbox({min:1,max:99,precision:0});
	});
 */</script>
	
</head>
<body >

 <div id="mainPanle"> 
<table id="areaTreeGrid" border="0" cellspacing="0" cellpadding="1" >
	<thead>
		<tr>
		    <th field="areaNameH" width="200" >名称</th>
		    <th field="areaCode" width="80" >编号</th>
		    <th field="statusDesc" width="60">状态</th>
		    <th field="level" width="30">级别</th>
			<th field="sort" width="30">排序</th>
			<th field="createTime" width="180">更新时间</th>
		</tr>
		
	</thead>
</table>
</div>

   <#include "./add.html">
   <#include "./update.html">
<div id="rightMenu" class="easyui-menu" style="width:120px;">
		<div iconCls="icon-add"  onclick="add();">新建</div>
		<div iconCls="icon-cut" onclick="modify();">修改</div>
		<div iconCls="icon-remove" onclick="deleteArea();">删除</div>
	</div>
</body>
</html>