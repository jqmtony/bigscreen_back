<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<#include "/frame/pageInclude.html">
<script type="text/javascript">
	$(document).ready(function() {
		grid = $('#tab').datagrid( {
			//title : '用户列表',			
			url :'${base}/device/queryList',
			queryParams:$("#queryForm").serializeObject(),
			pagination : true,
			rownumbers : true,
			singleSelect : true,
			striped:true,
			fit:true,
			toolbar:'#toolbar',
			fitColumns:true,
			onDblClickRow:function(index,row){
				modifyRow(row);
			} 
		});
		
		$("#add-window, #modify-window").window({ 
	        width:400,
	        height:320
		});
		
	});
	//保证设备编码的唯一性
	function checkCode(id, deviceId, code, url){
		$.ajax({  
			    url:url,   
			    data:{  
			    	id : deviceId,
			    	code : code
			    },  
			    type:'post',  
			    dataType:'json',  
			    success:function(data) { 
			        if(data == false ){
			        	alert("编码已存在，请重新输入！");
			            $("#"+id).val(''); 
			            $("#"+id).focus();
			        } 
			     },  
			     error : function() {  
			          alert("异常！");  
			     }  
			});
	}
	
</script>
</head>
<body>

   <table class="easyui-datagrid" id="tab">
		<thead>
			<tr>
				<th data-options="field:'code',width:100">设备编码</th>
				<th data-options="field:'brand',width:80">设备品牌</th>
				<th data-options="field:'model',width:100">设备型号</th>
				<th data-options="field:'mac',width:80">设备mac</th>
				<th data-options="field:'userName',width:50">商家负责人</th>
				<th data-options="field:'cname',width:80">商铺名称</th>
				<th data-options="field:'countryCode',width:50,formatter:formatCountry">国家</th>
				<th data-options="field:'areaCode',width:50,formatter:formatArea">地区</th>
				<th data-options="field:'cityCode',width:50,formatter:formatCity">城市</th>
				<th data-options="field:'screenNum',width:50,formatter:formatScreenNum">分屏数量</th>
				<th data-options="field:'createTime',width:100,formatter:formatYYYYMMDD">创建日期</th>
				<th data-options="field:'status',width:50,formatter:formatStatus">状态</th>
			</tr>
		</thead>
	</table>
	<div id="toolbar" style="padding:2px 5px;">
	
		<form id="queryForm">
			 地区：	 <select id="query_code" name="query_code" class="easyui-combotree" data-options="url:'${base}/area/areaStaticTree',method:'get'"  style="width:150px;"></select>
    			 	 <input type="hidden" id="queryCountryCode" name="countryCode"></input> 
    			 	 <input type="hidden" id="queryAreaCode" name="areaCode"></input> 
    			 	 <input type="hidden" id="queryCityCode" name="cityCode"></input>
		           设备编码： <input type="text" class="easyui-validatebox textbox" id="code" name="code" style="width:110px"></input>
		           设备品牌： <input type="text" class="easyui-validatebox textbox" id="mac" name="mac" style="width:110px"></input>
		           分屏数量： <select id="screenNum" class="easyui-combobox" data-options="editable:false" name="screenNum"  style="width:90px;">
		           		<option value="0" selected>--请选择--</option>
	    				<option value="4">大屏</option>
		           		<option value="1">小屏</option>
		           	</select>
			<a href="javascript:void(0);" onclick="queryWithCode()" class="easyui-linkbutton" iconCls="icon-search">查询</a>
		</form>	
		<div style="margin:5px">
			<a href="javascript:void(0);" onclick="add();" class="easyui-linkbutton" data-options="iconCls:'icon-add',toggle:true">新增</a>
			<a href="javascript:void(0);" onclick="modify();" class="easyui-linkbutton" data-options="iconCls:'icon-edit',toggle:true">修改</a>
			<a href="javascript:void(0);" onclick="removeModule();" class="easyui-linkbutton" data-options="iconCls:'icon-remove',toggle:true">删除</a>
		</div>
	</div>
	
   <#include "./add.html">
   <#include "./update.html">
   <div id="lookUpSelect-window" title="选择商铺"></div>
</body>
</html>
