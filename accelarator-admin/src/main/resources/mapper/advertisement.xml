<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gochinatv.accelarator.dao.AdvertisementDao">

	<resultMap type="Advertisement" id="Advertisement">
		<id property="id" column="id" />
		<result property="type" column="type" />
		<result property="videoPath" column="video_path" />
		<result property="picPath" column="pic_path" />
		<result property="content" column="content" />
		<result property="advertiserId" column="advertiser_id" />
		<result property="startTime" column="start_time" />
		<result property="endTime" column="end_time" />
		<result property="duration" column="duration" />
		<result property="remark" column="remark" />
		<result property="status" column="status" />
		
		<result property="userName" column="user_name" />
		<result property="realName" column="real_name" />
	</resultMap>
	
	<select id="getListByEntity" resultMap="Advertisement" parameterType="Advertisement">
		select atm.id,at.user_name,at.real_name,atm.start_time,atm.end_time,atm.duration,atm.status,atm.remark 
		       from advertisement atm left join advertiser at on atm.advertiser_id=at.id 
	   <where>
			1=1
			<if test="source!=0">
				and atm.source=#{source}
			</if>
			<if test="status!=0">
				and atm.status=#{status} 
			</if>
			<if test="realName!=null and realName!=''">
				and at.real_name like CONCAT(CONCAT('%',#{realName}),'%')
			</if>
		</where>
		order by id desc
	</select>

	<insert id="save" parameterType="Advertisement">
	   insert into advertisement(
	            type,
	            video_path,
	            pic_path,
	            content,
	            advertiser_id,
	            start_time,
	            end_time,
	            duration,
	            remark,
	            status
	            ) values (
	            #{type},
	            #{videoPath},
	            #{picPath},
	            #{content},
	            #{advertiserId},
	            #{startTime},
	            #{endTime},
	            #{duration},
	            #{remark},
	            #{status}
	            )
	</insert>
	
	<update id="update" parameterType="Advertisement">
		update advertisement
		<set>
			type=#{type},
            video_path=#{videoPath},
            pic_path=#{picPath},
            content=#{content},
            advertiser_id=#{advertiserId},
            start_time=#{startTime},
            end_time=#{endTime},
            duration=#{duration},
            remark=#{remark},
            status=#{status}
		</set>
		where id = #{id}
	</update>
	
	<delete id="deleteByEntity" parameterType="Advertisement">
	  delete from advertisement where id = #{id}
	</delete>
	
</mapper>